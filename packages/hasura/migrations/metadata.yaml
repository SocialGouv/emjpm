version: 2
tables:
- table:
    schema: public
    name: access_tokens
  object_relationships:
  - name: editors
    using:
      manual_configuration:
        remote_table:
          schema: public
          name: editors
        column_mapping:
          editor_id: id
  select_permissions:
  - role: individuel
    permission:
      columns:
      - id
      - user_id
      - access_token
      - editor_id
      - editor_url
      filter:
        user_id:
          _eq: X-Hasura-User-Id
  - role: prepose
    permission:
      columns:
      - editor_id
      - id
      - user_id
      - access_token
      - editor_url
      filter:
        user_id:
          _eq: X-Hasura-User-Id
  - role: service
    permission:
      columns:
      - editor_id
      - id
      - user_id
      - access_token
      - editor_url
      filter:
        user_id:
          _eq: X-Hasura-User-Id
  delete_permissions:
  - role: individuel
    permission:
      filter:
        user_id:
          _eq: X-Hasura-User-Id
  - role: prepose
    permission:
      filter:
        user_id:
          _eq: X-Hasura-User-Id
  - role: service
    permission:
      filter:
        user_id:
          _eq: X-Hasura-User-Id
- table:
    schema: public
    name: api_logs
  object_relationships:
  - name: editor
    using:
      foreign_key_constraint_on: editor_id
- table:
    schema: public
    name: city
  select_permissions:
  - role: direction
    permission:
      columns:
      - id
      - code_postal
      - ville
      - latitude
      - longitude
      filter: {}
  - role: prepose
    permission:
      columns:
      - id
      - code_postal
      - ville
      - latitude
      - longitude
      filter: {}
  - role: service
    permission:
      columns:
      - id
      - code_postal
      - ville
      - latitude
      - longitude
      filter: {}
  - role: ti
    permission:
      columns:
      - id
      - code_postal
      - ville
      - latitude
      - longitude
      filter: {}
- table:
    schema: public
    name: commentaires
  object_relationships:
  - name: mandataire
    using:
      foreign_key_constraint_on: mandataire_id
  - name: service_antenne
    using:
      foreign_key_constraint_on: antenne_id
  - name: ti
    using:
      foreign_key_constraint_on: ti_id
  insert_permissions:
  - role: ti
    permission:
      check:
        ti:
          magistrats:
            user:
              id:
                _eq: X-Hasura-User-Id
      columns:
      - comment
      - created_at
      - id
      - mandataire_id
      - service_id
      - ti_id
  select_permissions:
  - role: ti
    permission:
      columns:
      - comment
      - created_at
      - id
      - mandataire_id
      - service_id
      - ti_id
      filter:
        ti:
          magistrats:
            user:
              id:
                _eq: X-Hasura-User-Id
  update_permissions:
  - role: ti
    permission:
      columns:
      - comment
      - created_at
      - id
      - mandataire_id
      - service_id
      - ti_id
      filter:
        ti:
          magistrats:
            user:
              id:
                _eq: X-Hasura-User-Id
  delete_permissions:
  - role: ti
    permission:
      filter:
        ti:
          magistrats:
            user:
              id:
                _eq: X-Hasura-User-Id
- table:
    schema: public
    name: departements
  object_relationships:
  - name: region
    using:
      foreign_key_constraint_on: id_region
  array_relationships:
  - name: mandataires
    using:
      foreign_key_constraint_on:
        column: department_id
        table:
          schema: public
          name: mandataires
  - name: mesures
    using:
      foreign_key_constraint_on:
        column: department_id
        table:
          schema: public
          name: mesures
  - name: services
    using:
      foreign_key_constraint_on:
        column: department_id
        table:
          schema: public
          name: services
  select_permissions:
  - role: anonymous
    permission:
      columns:
      - id
      - id_region
      - code
      - nom
      filter: {}
  - role: direction
    permission:
      columns:
      - id
      - id_region
      - code
      - nom
      filter: {}
  - role: individuel
    permission:
      columns:
      - id
      - id_region
      - code
      - nom
      filter: {}
  - role: prepose
    permission:
      columns:
      - id
      - id_region
      - code
      - nom
      filter: {}
  - role: service
    permission:
      columns:
      - id
      - id_region
      - code
      - nom
      filter: {}
  - role: ti
    permission:
      columns:
      - id
      - id_region
      - code
      - nom
      filter: {}
- table:
    schema: public
    name: direction
  insert_permissions:
  - role: direction
    permission:
      check:
        user_id:
          _eq: X-Hasura-User-Id
      set:
        user_id: x-hasura-User-Id
      columns:
      - id
      - region_id
      - user_id
      - department_id
  select_permissions:
  - role: direction
    permission:
      columns:
      - id
      - region_id
      - user_id
      - department_id
      filter:
        user_id:
          _eq: X-Hasura-User-Id
  update_permissions:
  - role: direction
    permission:
      columns:
      - id
      - region_id
      - user_id
      - department_id
      filter:
        user_id:
          _eq: X-Hasura-User-Id
      set:
        user_id: x-hasura-User-Id
- table:
    schema: public
    name: editor_token_requests
  insert_permissions:
  - role: anonymous
    permission:
      check: {}
      columns:
      - email
      - name
  event_triggers:
  - name: token-request
    definition:
      enable_manual: false
      insert:
        columns: '*'
    retry_conf:
      num_retries: 0
      interval_sec: 10
      timeout_sec: 60
    webhook_from_env: WEB_HOOK_URL_TOKEN_REQUEST
- table:
    schema: public
    name: editors
  select_permissions:
  - role: individuel
    permission:
      columns:
      - id
      - api_token
      - name
      filter: {}
  - role: prepose
    permission:
      columns:
      - id
      - api_token
      - name
      filter: {}
  - role: service
    permission:
      columns:
      - id
      - api_token
      - name
      filter: {}
- table:
    schema: public
    name: enquete_individuels
  object_relationships:
  - name: mandataire
    using:
      foreign_key_constraint_on: mandataire_id
  array_relationships:
  - name: enquete_reponses
    using:
      foreign_key_constraint_on:
        column: individuel_id
        table:
          schema: public
          name: enquete_reponses
  insert_permissions:
  - role: individuel
    permission:
      check:
        mandataire:
          user_id:
            _eq: X-Hasura-User-Id
      columns:
      - id
      - mandataire_id
      - estimation_etp
      - secretaire_specialise
      - secretaire_specialise_etp
      - cumul_prepose
      - cumul_prepose_etp
      - cumul_delegue_service
      - cumul_delegue_service_etp
      - debut_activite_avant_2009
      - annee_debut_activite
      - annee_agrement
      - cnc_mjpm_annee_obtention
      - cnc_mjpm_heure_formation
      - cnc_maj_annee_obtention
      - cnc_maj_heure_formation
      - cnc_dpf_annee_obtention
      - cnc_dpf_heure_formation
      - niveau_qualification
      - niveau_qualification_secretaire_spe
  select_permissions:
  - role: individuel
    permission:
      columns:
      - id
      - mandataire_id
      - estimation_etp
      - secretaire_specialise
      - secretaire_specialise_etp
      - cumul_prepose
      - cumul_prepose_etp
      - cumul_delegue_service
      - cumul_delegue_service_etp
      - debut_activite_avant_2009
      - annee_debut_activite
      - annee_agrement
      - cnc_mjpm_annee_obtention
      - cnc_mjpm_heure_formation
      - cnc_maj_annee_obtention
      - cnc_maj_heure_formation
      - cnc_dpf_annee_obtention
      - cnc_dpf_heure_formation
      - niveau_qualification
      - niveau_qualification_secretaire_spe
      filter:
        mandataire:
          user_id:
            _eq: X-Hasura-User-Id
  update_permissions:
  - role: individuel
    permission:
      columns:
      - id
      - mandataire_id
      - estimation_etp
      - secretaire_specialise
      - secretaire_specialise_etp
      - cumul_prepose
      - cumul_prepose_etp
      - cumul_delegue_service
      - cumul_delegue_service_etp
      - debut_activite_avant_2009
      - annee_debut_activite
      - annee_agrement
      - cnc_mjpm_annee_obtention
      - cnc_mjpm_heure_formation
      - cnc_maj_annee_obtention
      - cnc_maj_heure_formation
      - cnc_dpf_annee_obtention
      - cnc_dpf_heure_formation
      - niveau_qualification
      - niveau_qualification_secretaire_spe
      filter:
        mandataire:
          user_id:
            _eq: X-Hasura-User-Id
- table:
    schema: public
    name: enquete_preposes
  object_relationships:
  - name: mandataire
    using:
      foreign_key_constraint_on: mandataire_id
  array_relationships:
  - name: enquete_reponses
    using:
      foreign_key_constraint_on:
        column: prepose_id
        table:
          schema: public
          name: enquete_reponses
- table:
    schema: public
    name: enquete_reponses
  object_relationships:
  - name: enquete
    using:
      foreign_key_constraint_on: enquete_id
  - name: enquete_individuel
    using:
      foreign_key_constraint_on: individuel_id
  - name: enquete_prepose
    using:
      foreign_key_constraint_on: prepose_id
  - name: enquete_service
    using:
      foreign_key_constraint_on: service_id
  insert_permissions:
  - role: individuel
    permission:
      check: {}
      columns:
      - activite_accompagnement_judiciaire_domicile_debut_annee
      - activite_accompagnement_judiciaire_domicile_fin_annee
      - activite_accompagnement_judiciaire_etablissement_debut_annee
      - activite_accompagnement_judiciaire_etablissement_fin_annee
      - activite_curatelle_biens_domicile_debut_annee
      - activite_curatelle_biens_domicile_fin_annee
      - activite_curatelle_biens_etablissement_debut_annee
      - activite_curatelle_biens_etablissement_fin_annee
      - activite_curatelle_personne_domicile_debut_annee
      - activite_curatelle_personne_domicile_fin_annee
      - activite_curatelle_personne_etablissement_debut_annee
      - activite_curatelle_personne_etablissement_fin_annee
      - activite_curatelle_renforcee_domicile_debut_annee
      - activite_curatelle_renforcee_domicile_fin_annee
      - activite_curatelle_renforcee_etablissement_debut_annee
      - activite_curatelle_renforcee_etablissement_fin_annee
      - activite_curatelle_simple_domicile_debut_annee
      - activite_curatelle_simple_domicile_fin_annee
      - activite_curatelle_simple_etablissement_debut_annee
      - activite_curatelle_simple_etablissement_fin_annee
      - activite_revisions_autre
      - activite_revisions_changement
      - activite_revisions_main_levee
      - activite_revisions_masp
      - activite_revisions_reconduction
      - activite_sorties_deces
      - activite_sorties_main_levee
      - activite_sorties_masp
      - activite_tutelle_domicile_debut_annee
      - activite_tutelle_domicile_fin_annee
      - activite_tutelle_etablissement_debut_annee
      - activite_tutelle_etablissement_fin_annee
      - enquete_id
      - id
      - individuel_id
      - populations_repartition_age_autre_femme
      - populations_repartition_age_autre_homme
      - populations_repartition_age_curatelle_femme
      - populations_repartition_age_curatelle_homme
      - populations_repartition_age_sauvegarde_justice_femme
      - populations_repartition_age_sauvegarde_justice_homme
      - populations_repartition_age_tpsa_femme
      - populations_repartition_age_tpsa_homme
      - populations_repartition_age_tutelle_femme
      - populations_repartition_age_tutelle_homme
      - populations_repartition_anciennete_autre_femme
      - populations_repartition_anciennete_autre_homme
      - populations_repartition_anciennete_curatelle_femme
      - populations_repartition_anciennete_curatelle_homme
      - populations_repartition_anciennete_sauvegarde_justice_femme
      - populations_repartition_anciennete_sauvegarde_justice_homme
      - populations_repartition_anciennete_tpsa_femme
      - populations_repartition_anciennete_tpsa_homme
      - populations_repartition_anciennete_tutelle_femme
      - populations_repartition_anciennete_tutelle_homme
      - populations_repartition_nature_ehpad
      - populations_repartition_nature_etablissements
      - populations_repartition_nature_services
      - prepose_id
      - service_id
      - last_update
      - type
  select_permissions:
  - role: individuel
    permission:
      columns:
      - id
      - type
      - enquete_id
      - individuel_id
      - service_id
      - prepose_id
      - last_update
      - activite_curatelle_renforcee_etablissement_debut_annee
      - activite_curatelle_renforcee_etablissement_fin_annee
      - activite_curatelle_renforcee_domicile_debut_annee
      - activite_curatelle_renforcee_domicile_fin_annee
      - activite_curatelle_simple_etablissement_debut_annee
      - activite_curatelle_simple_etablissement_fin_annee
      - activite_curatelle_simple_domicile_debut_annee
      - activite_curatelle_simple_domicile_fin_annee
      - activite_tutelle_etablissement_debut_annee
      - activite_tutelle_etablissement_fin_annee
      - activite_tutelle_domicile_debut_annee
      - activite_tutelle_domicile_fin_annee
      - activite_accompagnement_judiciaire_etablissement_debut_annee
      - activite_accompagnement_judiciaire_etablissement_fin_annee
      - activite_accompagnement_judiciaire_domicile_debut_annee
      - activite_accompagnement_judiciaire_domicile_fin_annee
      - activite_curatelle_biens_etablissement_debut_annee
      - activite_curatelle_biens_etablissement_fin_annee
      - activite_curatelle_biens_domicile_debut_annee
      - activite_curatelle_biens_domicile_fin_annee
      - activite_curatelle_personne_etablissement_debut_annee
      - activite_curatelle_personne_etablissement_fin_annee
      - activite_curatelle_personne_domicile_debut_annee
      - activite_curatelle_personne_domicile_fin_annee
      - activite_revisions_main_levee
      - activite_revisions_masp
      - activite_revisions_reconduction
      - activite_revisions_changement
      - activite_revisions_autre
      - activite_sorties_main_levee
      - activite_sorties_deces
      - activite_sorties_masp
      - populations_repartition_age_tutelle_homme
      - populations_repartition_age_tutelle_femme
      - populations_repartition_age_curatelle_homme
      - populations_repartition_age_curatelle_femme
      - populations_repartition_age_tpsa_homme
      - populations_repartition_age_tpsa_femme
      - populations_repartition_age_sauvegarde_justice_homme
      - populations_repartition_age_sauvegarde_justice_femme
      - populations_repartition_age_autre_homme
      - populations_repartition_age_autre_femme
      - populations_repartition_anciennete_tutelle_homme
      - populations_repartition_anciennete_tutelle_femme
      - populations_repartition_anciennete_curatelle_homme
      - populations_repartition_anciennete_curatelle_femme
      - populations_repartition_anciennete_tpsa_homme
      - populations_repartition_anciennete_tpsa_femme
      - populations_repartition_anciennete_sauvegarde_justice_homme
      - populations_repartition_anciennete_sauvegarde_justice_femme
      - populations_repartition_anciennete_autre_homme
      - populations_repartition_anciennete_autre_femme
      - populations_repartition_nature_etablissements
      - populations_repartition_nature_services
      - populations_repartition_nature_ehpad
      filter: {}
  update_permissions:
  - role: individuel
    permission:
      columns:
      - activite_accompagnement_judiciaire_domicile_debut_annee
      - activite_accompagnement_judiciaire_domicile_fin_annee
      - activite_accompagnement_judiciaire_etablissement_debut_annee
      - activite_accompagnement_judiciaire_etablissement_fin_annee
      - activite_curatelle_biens_domicile_debut_annee
      - activite_curatelle_biens_domicile_fin_annee
      - activite_curatelle_biens_etablissement_debut_annee
      - activite_curatelle_biens_etablissement_fin_annee
      - activite_curatelle_personne_domicile_debut_annee
      - activite_curatelle_personne_domicile_fin_annee
      - activite_curatelle_personne_etablissement_debut_annee
      - activite_curatelle_personne_etablissement_fin_annee
      - activite_curatelle_renforcee_domicile_debut_annee
      - activite_curatelle_renforcee_domicile_fin_annee
      - activite_curatelle_renforcee_etablissement_debut_annee
      - activite_curatelle_renforcee_etablissement_fin_annee
      - activite_curatelle_simple_domicile_debut_annee
      - activite_curatelle_simple_domicile_fin_annee
      - activite_curatelle_simple_etablissement_debut_annee
      - activite_curatelle_simple_etablissement_fin_annee
      - activite_revisions_autre
      - activite_revisions_changement
      - activite_revisions_main_levee
      - activite_revisions_masp
      - activite_revisions_reconduction
      - activite_sorties_deces
      - activite_sorties_main_levee
      - activite_sorties_masp
      - activite_tutelle_domicile_debut_annee
      - activite_tutelle_domicile_fin_annee
      - activite_tutelle_etablissement_debut_annee
      - activite_tutelle_etablissement_fin_annee
      - enquete_id
      - id
      - individuel_id
      - populations_repartition_age_autre_femme
      - populations_repartition_age_autre_homme
      - populations_repartition_age_curatelle_femme
      - populations_repartition_age_curatelle_homme
      - populations_repartition_age_sauvegarde_justice_femme
      - populations_repartition_age_sauvegarde_justice_homme
      - populations_repartition_age_tpsa_femme
      - populations_repartition_age_tpsa_homme
      - populations_repartition_age_tutelle_femme
      - populations_repartition_age_tutelle_homme
      - populations_repartition_anciennete_autre_femme
      - populations_repartition_anciennete_autre_homme
      - populations_repartition_anciennete_curatelle_femme
      - populations_repartition_anciennete_curatelle_homme
      - populations_repartition_anciennete_sauvegarde_justice_femme
      - populations_repartition_anciennete_sauvegarde_justice_homme
      - populations_repartition_anciennete_tpsa_femme
      - populations_repartition_anciennete_tpsa_homme
      - populations_repartition_anciennete_tutelle_femme
      - populations_repartition_anciennete_tutelle_homme
      - populations_repartition_nature_ehpad
      - populations_repartition_nature_etablissements
      - populations_repartition_nature_services
      - prepose_id
      - service_id
      - last_update
      - type
      filter: {}
- table:
    schema: public
    name: enquete_services
  object_relationships:
  - name: service
    using:
      foreign_key_constraint_on: service_id
  array_relationships:
  - name: enquete_reponses
    using:
      foreign_key_constraint_on:
        column: service_id
        table:
          schema: public
          name: enquete_reponses
- table:
    schema: public
    name: enquetes
  array_relationships:
  - name: enquete_reponses
    using:
      foreign_key_constraint_on:
        column: enquete_id
        table:
          schema: public
          name: enquete_reponses
  insert_permissions:
  - role: direction
    permission:
      check: {}
      columns:
      - id
      - created_at
      - date_fin
      - annee
      - status
  select_permissions:
  - role: direction
    permission:
      columns:
      - id
      - created_at
      - annee
      - status
      - date_fin
      filter: {}
  - role: individuel
    permission:
      columns:
      - annee
      - created_at
      - date_fin
      - id
      - status
      filter: {}
  update_permissions:
  - role: direction
    permission:
      columns:
      - id
      - created_at
      - date_fin
      - annee
      - status
      filter: {}
- table:
    schema: public
    name: etablissements
  array_relationships:
  - name: mandataire_etablissements
    using:
      foreign_key_constraint_on:
        column: etablissement_id
        table:
          schema: public
          name: mandataire_etablissements
  - name: mesures
    using:
      foreign_key_constraint_on:
        column: etablissement_id
        table:
          schema: public
          name: mesures
  select_permissions:
  - role: direction
    permission:
      columns:
      - id
      - id_finess
      - nom
      - adresse
      - code_postal
      - ville
      - tel
      - fax
      filter: {}
  - role: prepose
    permission:
      columns:
      - latitude
      - longitude
      - id
      - adresse
      - code_postal
      - fax
      - id_finess
      - nom
      - tel
      - ville
      filter: {}
  - role: service
    permission:
      columns:
      - id
      - id_finess
      - nom
      - adresse
      - code_postal
      - ville
      - tel
      - fax
      - latitude
      - longitude
      filter: {}
  - role: ti
    permission:
      columns:
      - latitude
      - longitude
      - id
      - adresse
      - code_postal
      - fax
      - id_finess
      - nom
      - tel
      - ville
      filter: {}
- table:
    schema: public
    name: geolocalisation_code_postal
  select_permissions:
  - role: anonymous
    permission:
      columns:
      - cities
      - code_postal
      - id
      - latitude
      - longitude
      filter: {}
  - role: direction
    permission:
      columns:
      - id
      - code_postal
      - latitude
      - longitude
      - cities
      filter: {}
  - role: individuel
    permission:
      columns:
      - latitude
      - longitude
      - id
      - cities
      - code_postal
      filter: {}
  - role: prepose
    permission:
      columns:
      - latitude
      - longitude
      - id
      - cities
      - code_postal
      filter: {}
  - role: service
    permission:
      columns:
      - cities
      - code_postal
      - id
      - latitude
      - longitude
      filter: {}
  - role: ti
    permission:
      columns:
      - latitude
      - longitude
      - id
      - cities
      - code_postal
      filter: {}
- table:
    schema: public
    name: individuel_agrement_departements
  object_relationships:
  - name: departement
    using:
      foreign_key_constraint_on: departement_id
  - name: mandataire
    using:
      foreign_key_constraint_on: mandataire_id
  insert_permissions:
  - role: individuel
    permission:
      check: {}
      columns:
      - id
      - created_at
      - mandataire_id
      - agrement_id
      - departement_id
      - departement_financeur
  select_permissions:
  - role: individuel
    permission:
      columns:
      - departement_financeur
      - agrement_id
      - departement_id
      - id
      - mandataire_id
      - created_at
      filter:
        mandataire:
          user_id:
            _eq: X-Hasura-User-Id
  update_permissions:
  - role: individuel
    permission:
      columns:
      - departement_financeur
      filter:
        mandataire:
          user_id:
            _eq: X-Hasura-User-Id
  delete_permissions:
  - role: individuel
    permission:
      filter:
        mandataire:
          user_id:
            _eq: X-Hasura-User-Id
- table:
    schema: public
    name: individuel_agrements
  object_relationships:
  - name: mandataire
    using:
      foreign_key_constraint_on: mandataire_id
  array_relationships:
  - name: individuel_agrement_departements
    using:
      foreign_key_constraint_on:
        column: agrement_id
        table:
          schema: public
          name: individuel_agrement_departements
  select_permissions:
  - role: individuel
    permission:
      columns:
      - id
      - created_at
      - mandataire_id
      - debut_activite_avant_2009
      - annee_debut_activite
      - annee_agrement
      filter:
        mandataire:
          user_id:
            _eq: X-Hasura-User-Id
  update_permissions:
  - role: individuel
    permission:
      columns:
      - id
      - created_at
      - mandataire_id
      - debut_activite_avant_2009
      - annee_debut_activite
      - annee_agrement
      filter:
        mandataire:
          user_id:
            _eq: X-Hasura-User-Id
- table:
    schema: public
    name: individuel_exercices
  object_relationships:
  - name: mandataire
    using:
      foreign_key_constraint_on: mandataire_id
  select_permissions:
  - role: individuel
    permission:
      columns:
      - id
      - created_at
      - mandataire_id
      - estimation_etp
      - secretariat_specialise
      - secretariat_specialise_etp
      - cumul_prepose
      - cumul_prepose_etp
      - cumul_delegue_service
      - cumul_delegue_service_etp
      filter:
        mandataire:
          user_id:
            _eq: X-Hasura-User-Id
  update_permissions:
  - role: individuel
    permission:
      columns:
      - id
      - created_at
      - mandataire_id
      - estimation_etp
      - secretariat_specialise
      - secretariat_specialise_etp
      - cumul_prepose
      - cumul_prepose_etp
      - cumul_delegue_service
      - cumul_delegue_service_etp
      filter:
        mandataire:
          user_id:
            _eq: X-Hasura-User-Id
- table:
    schema: public
    name: individuel_formations
  object_relationships:
  - name: mandataire
    using:
      foreign_key_constraint_on: mandataire_id
  select_permissions:
  - role: individuel
    permission:
      columns:
      - id
      - created_at
      - mandataire_id
      - cnc_mjpm_annee_obtention
      - cnc_mjpm_heure_formation
      - cnc_maj_annee_obtention
      - cnc_maj_heure_formation
      - cnc_dpf_annee_obtention
      - cnc_dpf_heure_formation
      - niveau_qualification
      - niveau_qualification_secretaire_spe
      filter:
        mandataire:
          user_id:
            _eq: X-Hasura-User-Id
  update_permissions:
  - role: individuel
    permission:
      columns:
      - cnc_dpf_annee_obtention
      - cnc_dpf_heure_formation
      - cnc_maj_annee_obtention
      - cnc_maj_heure_formation
      - cnc_mjpm_annee_obtention
      - cnc_mjpm_heure_formation
      - created_at
      - id
      - mandataire_id
      - niveau_qualification
      - niveau_qualification_secretaire_spe
      filter:
        mandataire:
          user_id:
            _eq: X-Hasura-User-Id
- table:
    schema: public
    name: magistrat
  object_relationships:
  - name: ti
    using:
      foreign_key_constraint_on: ti_id
  - name: user
    using:
      foreign_key_constraint_on: user_id
  select_permissions:
  - role: ti
    permission:
      columns:
      - id
      - user_id
      - ti_id
      filter:
        user_id:
          _eq: X-Hasura-User-Id
- table:
    schema: public
    name: mandataire_etablissements
  object_relationships:
  - name: etablissement
    using:
      foreign_key_constraint_on: etablissement_id
  - name: mandataire
    using:
      foreign_key_constraint_on: mandataire_id
  insert_permissions:
  - role: prepose
    permission:
      check:
        mandataire:
          user_id:
            _eq: X-Hasura-User-Id
      columns:
      - etablissement_id
      - id
      - mandataire_id
      - created_at
  select_permissions:
  - role: prepose
    permission:
      columns:
      - etablissement_id
      - id
      - mandataire_id
      - created_at
      filter:
        mandataire:
          user_id:
            _eq: X-Hasura-User-Id
  - role: ti
    permission:
      columns:
      - id
      - etablissement_id
      - mandataire_id
      - created_at
      filter: {}
  update_permissions:
  - role: prepose
    permission:
      columns:
      - etablissement_id
      - id
      - mandataire_id
      - created_at
      filter:
        mandataire:
          user_id:
            _eq: X-Hasura-User-Id
  delete_permissions:
  - role: prepose
    permission:
      filter:
        mandataire:
          user_id:
            _eq: X-Hasura-User-Id
- table:
    schema: public
    name: mandataires
  object_relationships:
  - name: departement
    using:
      foreign_key_constraint_on: department_id
  - name: user
    using:
      foreign_key_constraint_on: user_id
  array_relationships:
  - name: commentaires
    using:
      foreign_key_constraint_on:
        column: mandataire_id
        table:
          schema: public
          name: commentaires
  - name: mandataire_etablissements
    using:
      foreign_key_constraint_on:
        column: mandataire_id
        table:
          schema: public
          name: mandataire_etablissements
  - name: mesures
    using:
      foreign_key_constraint_on:
        column: mandataire_id
        table:
          schema: public
          name: mesures
  insert_permissions:
  - role: individuel
    permission:
      check: {}
      columns:
      - adresse
      - code_postal
      - created_at
      - date_mesure_update
      - department_id
      - dispo_max
      - email_send
      - etablissement
      - genre
      - id
      - latitude
      - longitude
      - mesures_en_attente
      - mesures_en_cours
      - siret
      - telephone
      - telephone_portable
      - user_id
      - ville
      - competences
  - role: prepose
    permission:
      check:
        user_id:
          _eq: X-Hasura-User-Id
      columns:
      - adresse
      - code_postal
      - created_at
      - date_mesure_update
      - dispo_max
      - email_send
      - etablissement
      - genre
      - id
      - latitude
      - longitude
      - mesures_en_attente
      - mesures_en_cours
      - siret
      - telephone
      - telephone_portable
      - user_id
      - ville
      - competences
  select_permissions:
  - role: anonymous
    permission:
      columns:
      - siret
      filter:
        siret:
          _eq: X-Hasura-Siret
      limit: 1
      allow_aggregations: true
  - role: direction
    permission:
      columns:
      - id
      - etablissement
      - code_postal
      - ville
      - telephone
      - adresse
      - mesures_en_cours
      - dispo_max
      - user_id
      - telephone_portable
      - created_at
      - date_mesure_update
      - email_send
      - genre
      - mesures_en_attente
      - competences
      filter: {}
      allow_aggregations: true
  - role: individuel
    permission:
      columns:
      - id
      - etablissement
      - code_postal
      - ville
      - telephone
      - adresse
      - mesures_en_cours
      - dispo_max
      - user_id
      - telephone_portable
      - created_at
      - date_mesure_update
      - email_send
      - genre
      - mesures_en_attente
      - competences
      - department_id
      - siret
      - latitude
      - longitude
      filter:
        user_id:
          _eq: X-Hasura-User-Id
  - role: prepose
    permission:
      columns:
      - latitude
      - longitude
      - department_id
      - dispo_max
      - id
      - mesures_en_attente
      - mesures_en_cours
      - user_id
      - competences
      - created_at
      - date_mesure_update
      - email_send
      - adresse
      - code_postal
      - etablissement
      - genre
      - siret
      - telephone
      - telephone_portable
      - ville
      filter:
        user_id:
          _eq: X-Hasura-User-Id
  - role: ti
    permission:
      columns:
      - id
      - etablissement
      - code_postal
      - ville
      - telephone
      - adresse
      - mesures_en_cours
      - dispo_max
      - user_id
      - telephone_portable
      - created_at
      - date_mesure_update
      - email_send
      - genre
      - mesures_en_attente
      - competences
      - department_id
      - siret
      - latitude
      - longitude
      filter: {}
  update_permissions:
  - role: individuel
    permission:
      columns:
      - adresse
      - code_postal
      - created_at
      - date_mesure_update
      - department_id
      - dispo_max
      - email_send
      - etablissement
      - genre
      - id
      - latitude
      - longitude
      - mesures_en_attente
      - mesures_en_cours
      - siret
      - telephone
      - telephone_portable
      - user_id
      - ville
      - competences
      filter:
        user_id:
          _eq: X-Hasura-User-Id
  - role: prepose
    permission:
      columns:
      - adresse
      - code_postal
      - created_at
      - date_mesure_update
      - department_id
      - dispo_max
      - email_send
      - etablissement
      - genre
      - id
      - latitude
      - longitude
      - mesures_en_attente
      - mesures_en_cours
      - siret
      - telephone
      - telephone_portable
      - user_id
      - ville
      - competences
      filter:
        user_id:
          _eq: X-Hasura-User-Id
  - role: ti
    permission:
      columns:
      - mesures_en_attente
      - mesures_en_cours
      filter: {}
- table:
    schema: public
    name: mesures
  object_relationships:
  - name: departement
    using:
      foreign_key_constraint_on: department_id
  - name: etablissementByEtablissementId
    using:
      foreign_key_constraint_on: etablissement_id
  - name: mandataire
    using:
      foreign_key_constraint_on: mandataire_id
  - name: service
    using:
      foreign_key_constraint_on: service_id
  - name: service_antenne
    using:
      foreign_key_constraint_on: antenne_id
  - name: ti
    using:
      foreign_key_constraint_on: ti_id
  insert_permissions:
  - role: individuel
    permission:
      check:
        mandataire:
          user_id:
            _eq: X-Hasura-User-Id
      columns:
      - annee
      - antenne_id
      - cabinet
      - civilite
      - code_postal
      - created_at
      - date_ouverture
      - department_id
      - etablissement
      - etablissement_id
      - extinction
      - id
      - is_urgent
      - judgment_date
      - latitude
      - longitude
      - mandataire_id
      - numero_dossier
      - numero_rg
      - pays
      - reason_extinction
      - residence
      - service_id
      - status
      - ti_id
      - type
      - ville
  - role: prepose
    permission:
      check:
        mandataire:
          user_id:
            _eq: X-Hasura-User-Id
      columns:
      - annee
      - antenne_id
      - cabinet
      - civilite
      - code_postal
      - created_at
      - date_ouverture
      - department_id
      - etablissement
      - etablissement_id
      - extinction
      - id
      - is_urgent
      - judgment_date
      - latitude
      - longitude
      - mandataire_id
      - numero_dossier
      - numero_rg
      - pays
      - reason_extinction
      - residence
      - service_id
      - status
      - ti_id
      - type
      - ville
  - role: service
    permission:
      check:
        service_id:
          _eq: X-Hasura-Service-Id
      set:
        service_id: x-hasura-Service-Id
      columns:
      - annee
      - antenne_id
      - cabinet
      - civilite
      - code_postal
      - created_at
      - date_ouverture
      - department_id
      - etablissement
      - etablissement_id
      - extinction
      - id
      - is_urgent
      - judgment_date
      - latitude
      - longitude
      - mandataire_id
      - numero_dossier
      - numero_rg
      - pays
      - reason_extinction
      - residence
      - service_id
      - status
      - ti_id
      - type
      - ville
  - role: ti
    permission:
      check: {}
      columns:
      - annee
      - antenne_id
      - cabinet
      - civilite
      - code_postal
      - created_at
      - date_ouverture
      - department_id
      - etablissement
      - etablissement_id
      - extinction
      - id
      - is_urgent
      - judgment_date
      - mandataire_id
      - numero_dossier
      - numero_rg
      - pays
      - reason_extinction
      - residence
      - service_id
      - status
      - ti_id
      - type
      - ville
  select_permissions:
  - role: direction
    permission:
      columns:
      - annee
      - antenne_id
      - cabinet
      - civilite
      - code_postal
      - created_at
      - date_ouverture
      - department_id
      - etablissement
      - etablissement_id
      - extinction
      - id
      - is_urgent
      - judgment_date
      - latitude
      - longitude
      - mandataire_id
      - numero_dossier
      - numero_rg
      - pays
      - reason_extinction
      - residence
      - service_id
      - status
      - ti_id
      - type
      - ville
      filter: {}
      allow_aggregations: true
  - role: individuel
    permission:
      columns:
      - annee
      - antenne_id
      - cabinet
      - civilite
      - code_postal
      - created_at
      - date_ouverture
      - department_id
      - etablissement
      - etablissement_id
      - extinction
      - id
      - is_urgent
      - judgment_date
      - latitude
      - longitude
      - mandataire_id
      - numero_dossier
      - numero_rg
      - pays
      - reason_extinction
      - residence
      - service_id
      - status
      - ti_id
      - type
      - ville
      filter:
        mandataire:
          user:
            id:
              _eq: X-Hasura-User-Id
      allow_aggregations: true
  - role: prepose
    permission:
      columns:
      - annee
      - antenne_id
      - cabinet
      - civilite
      - code_postal
      - created_at
      - date_ouverture
      - department_id
      - etablissement
      - etablissement_id
      - extinction
      - id
      - is_urgent
      - judgment_date
      - latitude
      - longitude
      - mandataire_id
      - numero_dossier
      - numero_rg
      - pays
      - reason_extinction
      - residence
      - service_id
      - status
      - ti_id
      - type
      - ville
      filter:
        mandataire:
          user_id:
            _eq: X-Hasura-User-Id
      allow_aggregations: true
  - role: service
    permission:
      columns:
      - annee
      - antenne_id
      - cabinet
      - civilite
      - code_postal
      - created_at
      - date_ouverture
      - department_id
      - etablissement
      - etablissement_id
      - extinction
      - id
      - is_urgent
      - judgment_date
      - latitude
      - longitude
      - mandataire_id
      - numero_dossier
      - numero_rg
      - pays
      - reason_extinction
      - residence
      - service_id
      - status
      - ti_id
      - type
      - ville
      filter:
        service_id:
          _eq: X-Hasura-Service-Id
      allow_aggregations: true
  - role: ti
    permission:
      columns:
      - annee
      - antenne_id
      - cabinet
      - civilite
      - code_postal
      - created_at
      - date_ouverture
      - department_id
      - etablissement
      - etablissement_id
      - extinction
      - id
      - is_urgent
      - judgment_date
      - latitude
      - longitude
      - mandataire_id
      - numero_dossier
      - numero_rg
      - pays
      - reason_extinction
      - residence
      - service_id
      - status
      - ti_id
      - type
      - ville
      filter:
        ti:
          magistrats:
            user_id:
              _eq: X-Hasura-User-Id
      allow_aggregations: true
  update_permissions:
  - role: individuel
    permission:
      columns:
      - annee
      - antenne_id
      - cabinet
      - civilite
      - code_postal
      - created_at
      - date_ouverture
      - department_id
      - etablissement
      - etablissement_id
      - extinction
      - id
      - is_urgent
      - judgment_date
      - latitude
      - longitude
      - mandataire_id
      - numero_dossier
      - numero_rg
      - pays
      - reason_extinction
      - residence
      - service_id
      - status
      - ti_id
      - type
      - ville
      filter:
        mandataire:
          user:
            id:
              _eq: X-Hasura-User-Id
  - role: prepose
    permission:
      columns:
      - annee
      - antenne_id
      - cabinet
      - civilite
      - code_postal
      - created_at
      - date_ouverture
      - department_id
      - etablissement
      - etablissement_id
      - extinction
      - id
      - is_urgent
      - judgment_date
      - latitude
      - longitude
      - mandataire_id
      - numero_dossier
      - numero_rg
      - pays
      - reason_extinction
      - residence
      - service_id
      - status
      - ti_id
      - type
      - ville
      filter:
        mandataire:
          user_id:
            _eq: X-Hasura-User-Id
  - role: service
    permission:
      columns:
      - annee
      - antenne_id
      - cabinet
      - civilite
      - code_postal
      - created_at
      - date_ouverture
      - department_id
      - etablissement
      - etablissement_id
      - extinction
      - id
      - is_urgent
      - judgment_date
      - latitude
      - longitude
      - mandataire_id
      - numero_dossier
      - numero_rg
      - pays
      - reason_extinction
      - residence
      - service_id
      - status
      - ti_id
      - type
      - ville
      filter:
        service_id:
          _eq: X-Hasura-Service-Id
  - role: ti
    permission:
      columns:
      - annee
      - antenne_id
      - cabinet
      - civilite
      - code_postal
      - created_at
      - date_ouverture
      - department_id
      - etablissement
      - etablissement_id
      - extinction
      - id
      - is_urgent
      - judgment_date
      - mandataire_id
      - numero_dossier
      - numero_rg
      - pays
      - reason_extinction
      - residence
      - service_id
      - status
      - ti_id
      - type
      - ville
      filter:
        ti:
          magistrats:
            user_id:
              _eq: X-Hasura-User-Id
  delete_permissions:
  - role: individuel
    permission:
      filter:
        mandataire:
          user:
            id:
              _eq: X-Hasura-User-Id
  - role: prepose
    permission:
      filter:
        mandataire:
          user_id:
            _eq: X-Hasura-User-Id
  - role: service
    permission:
      filter:
        service_id:
          _eq: X-Hasura-Service-Id
  - role: ti
    permission:
      filter:
        ti:
          magistrats:
            user_id:
              _eq: X-Hasura-User-Id
  event_triggers:
  - name: email
    definition:
      enable_manual: false
      insert:
        columns: '*'
    retry_conf:
      num_retries: 0
      interval_sec: 10
      timeout_sec: 60
    webhook_from_env: WEB_HOOK_URL_EMAIL_RESERVATION
  - name: email-cancel-reservation
    definition:
      enable_manual: false
      delete:
        columns: '*'
    retry_conf:
      num_retries: 0
      interval_sec: 10
      timeout_sec: 60
    webhook_from_env: WEB_HOOK_URL_EMAIL_CANCEL_RESERVATION
- table:
    schema: public
    name: mesures_import
  object_relationships:
  - name: service_antenne
    using:
      foreign_key_constraint_on: antenne_id
  - name: user
    using:
      foreign_key_constraint_on: user_id
  insert_permissions:
  - role: individuel
    permission:
      check: {}
      set:
        user_id: x-hasura-User-Id
      columns:
      - id
      - created_at
      - processed_at
      - content
      - file_name
      - file_size
      - file_type
      - status
      - user_id
      - antenne_id
  - role: prepose
    permission:
      check: {}
      set:
        user_id: x-hasura-User-Id
      columns:
      - antenne_id
      - file_size
      - id
      - user_id
      - content
      - created_at
      - processed_at
      - file_name
      - file_type
      - status
  - role: service
    permission:
      check: {}
      set:
        user_id: x-hasura-User-Id
      columns:
      - antenne_id
      - content
      - created_at
      - file_name
      - file_size
      - file_type
      - id
      - processed_at
      - service_id
      - status
      - user_id
  select_permissions:
  - role: service
    permission:
      columns:
      - antenne_id
      - file_size
      - id
      - user_id
      - content
      - created_at
      - processed_at
      - file_name
      - file_type
      - status
      filter:
        user_id:
          _eq: X-Hasura-User-Id
  update_permissions:
  - role: service
    permission:
      columns:
      - processed_at
      - status
      filter:
        user_id:
          _eq: X-Hasura-User-Id
  event_triggers:
  - name: import
    definition:
      enable_manual: false
      insert:
        columns: '*'
    retry_conf:
      num_retries: 0
      interval_sec: 10
      timeout_sec: 60
    webhook_from_env: WEB_HOOK_URL_MESURES_IMPORT
- table:
    schema: public
    name: regions
  array_relationships:
  - name: departements
    using:
      foreign_key_constraint_on:
        column: id_region
        table:
          schema: public
          name: departements
  select_permissions:
  - role: anonymous
    permission:
      columns:
      - id
      - nom
      filter: {}
  - role: direction
    permission:
      columns:
      - id
      - nom
      filter: {}
  - role: individuel
    permission:
      columns:
      - id
      - nom
      filter: {}
  - role: prepose
    permission:
      columns:
      - id
      - nom
      filter: {}
  - role: service
    permission:
      columns:
      - id
      - nom
      filter: {}
  - role: ti
    permission:
      columns:
      - id
      - nom
      filter: {}
- table:
    schema: public
    name: role
  array_relationships:
  - name: user_roles
    using:
      foreign_key_constraint_on:
        column: role_id
        table:
          schema: public
          name: user_role
  select_permissions:
  - role: anonymous
    permission:
      columns:
      - id
      - name
      filter: {}
  - role: direction
    permission:
      columns:
      - id
      - name
      filter: {}
  - role: individuel
    permission:
      columns:
      - id
      - name
      filter: {}
  - role: prepose
    permission:
      columns:
      - id
      - name
      filter: {}
  - role: service
    permission:
      columns:
      - id
      - name
      filter: {}
  - role: ti
    permission:
      columns:
      - id
      - name
      filter: {}
- table:
    schema: public
    name: satisfaction_campaign_answers
  object_relationships:
  - name: satisfaction_campaign
    using:
      foreign_key_constraint_on: satisfaction_campaign_id
  - name: user
    using:
      foreign_key_constraint_on: user_id
  insert_permissions:
  - role: direction
    permission:
      check: {}
      columns:
      - id
      - satisfaction_campaign_id
      - user_id
      - value
      - created_at
  - role: individuel
    permission:
      check: {}
      columns:
      - id
      - satisfaction_campaign_id
      - user_id
      - value
      - created_at
  - role: prepose
    permission:
      check: {}
      columns:
      - id
      - satisfaction_campaign_id
      - user_id
      - value
      - created_at
  - role: service
    permission:
      check: {}
      columns:
      - id
      - created_at
      - satisfaction_campaign_id
      - user_id
      - value
  - role: ti
    permission:
      check: {}
      columns:
      - id
      - created_at
      - satisfaction_campaign_id
      - user_id
      - value
  select_permissions:
  - role: direction
    permission:
      columns:
      - id
      - satisfaction_campaign_id
      - user_id
      - value
      - created_at
      filter: {}
  - role: individuel
    permission:
      columns:
      - id
      - satisfaction_campaign_id
      - user_id
      - value
      - created_at
      filter: {}
  - role: prepose
    permission:
      columns:
      - id
      - satisfaction_campaign_id
      - user_id
      - value
      - created_at
      filter: {}
  - role: service
    permission:
      columns:
      - id
      - created_at
      - satisfaction_campaign_id
      - user_id
      - value
      filter: {}
  - role: ti
    permission:
      columns:
      - id
      - satisfaction_campaign_id
      - user_id
      - value
      - created_at
      filter: {}
- table:
    schema: public
    name: satisfaction_campaigns
  array_relationships:
  - name: satisfaction_campaign_answers
    using:
      foreign_key_constraint_on:
        column: satisfaction_campaign_id
        table:
          schema: public
          name: satisfaction_campaign_answers
  select_permissions:
  - role: direction
    permission:
      columns:
      - id
      - created_at
      - ended_at
      - started_at
      - name
      filter: {}
  - role: individuel
    permission:
      columns:
      - id
      - created_at
      - ended_at
      - started_at
      - name
      filter: {}
  - role: prepose
    permission:
      columns:
      - id
      - created_at
      - ended_at
      - started_at
      - name
      filter: {}
  - role: service
    permission:
      columns:
      - id
      - created_at
      - ended_at
      - started_at
      - name
      filter: {}
      allow_aggregations: true
  - role: ti
    permission:
      columns:
      - id
      - created_at
      - name
      - started_at
      - ended_at
      filter: {}
- table:
    schema: public
    name: service_antenne
  object_relationships:
  - name: service
    using:
      foreign_key_constraint_on: service_id
  array_relationships:
  - name: commentaires
    using:
      foreign_key_constraint_on:
        column: antenne_id
        table:
          schema: public
          name: commentaires
  - name: mesures
    using:
      foreign_key_constraint_on:
        column: antenne_id
        table:
          schema: public
          name: mesures
  insert_permissions:
  - role: service
    permission:
      check: {}
      columns:
      - address
      - address_city
      - address_street
      - address_zip_code
      - bak_mandataire_id
      - contact_email
      - contact_firstname
      - contact_lastname
      - contact_phone
      - created_at
      - date_mesure_update
      - id
      - latitude
      - longitude
      - mesures_awaiting
      - mesures_in_progress
      - mesures_max
      - name
      - service_id
  select_permissions:
  - role: direction
    permission:
      columns:
      - id
      - service_id
      - name
      - created_at
      - address_street
      - address_zip_code
      - address_city
      - contact_lastname
      - contact_firstname
      - contact_email
      - contact_phone
      - mesures_awaiting
      - mesures_in_progress
      - mesures_max
      - date_mesure_update
      - bak_mandataire_id
      filter: {}
      allow_aggregations: true
  - role: individuel
    permission:
      columns:
      - id
      - service_id
      - name
      - created_at
      - address_street
      - address_zip_code
      - address_city
      - contact_lastname
      - contact_firstname
      - contact_email
      - contact_phone
      - mesures_awaiting
      - mesures_in_progress
      - mesures_max
      - date_mesure_update
      - bak_mandataire_id
      - address
      - latitude
      - longitude
      filter: {}
  - role: prepose
    permission:
      columns:
      - latitude
      - longitude
      - bak_mandataire_id
      - id
      - mesures_awaiting
      - mesures_in_progress
      - mesures_max
      - service_id
      - created_at
      - date_mesure_update
      - address
      - address_city
      - address_street
      - address_zip_code
      - contact_email
      - contact_firstname
      - contact_lastname
      - contact_phone
      - name
      filter: {}
  - role: service
    permission:
      columns:
      - address
      - address_city
      - address_street
      - address_zip_code
      - bak_mandataire_id
      - contact_email
      - contact_firstname
      - contact_lastname
      - contact_phone
      - created_at
      - date_mesure_update
      - id
      - latitude
      - longitude
      - mesures_awaiting
      - mesures_in_progress
      - mesures_max
      - name
      - service_id
      filter:
        service_id:
          _eq: x-hasura-service-id
      allow_aggregations: true
  - role: ti
    permission:
      columns:
      - id
      - service_id
      - name
      - created_at
      - address_street
      - address_zip_code
      - address_city
      - contact_lastname
      - contact_firstname
      - contact_email
      - contact_phone
      - mesures_awaiting
      - mesures_in_progress
      - mesures_max
      - date_mesure_update
      - bak_mandataire_id
      filter: {}
  update_permissions:
  - role: service
    permission:
      columns:
      - address
      - address_city
      - address_street
      - address_zip_code
      - bak_mandataire_id
      - contact_email
      - contact_firstname
      - contact_lastname
      - contact_phone
      - created_at
      - date_mesure_update
      - id
      - latitude
      - longitude
      - mesures_awaiting
      - mesures_in_progress
      - mesures_max
      - name
      - service_id
      filter: {}
  - role: ti
    permission:
      columns:
      - mesures_awaiting
      - mesures_in_progress
      filter: {}
  delete_permissions:
  - role: service
    permission:
      filter: {}
- table:
    schema: public
    name: service_member_invitations
  object_relationships:
  - name: service
    using:
      foreign_key_constraint_on: service_id
  insert_permissions:
  - role: service
    permission:
      check:
        service_id:
          _eq: X-Hasura-Service-Id
      columns:
      - id
      - email
      - token
      - created_at
      - sent_at
      - service_id
  select_permissions:
  - role: anonymous
    permission:
      columns:
      - email
      - id
      - service_id
      - token
      filter: {}
  - role: service
    permission:
      columns:
      - id
      - service_id
      - created_at
      - sent_at
      - email
      - token
      filter:
        service_id:
          _eq: X-Hasura-Service-Id
  delete_permissions:
  - role: service
    permission:
      filter:
        service_id:
          _eq: X-Hasura-Service-Id
  event_triggers:
  - name: email-service-member-invitation
    definition:
      enable_manual: false
      insert:
        columns: '*'
    retry_conf:
      num_retries: 0
      interval_sec: 10
      timeout_sec: 60
    webhook_from_env: WEB_HOOK_URL_EMAIL_SERVICE_MEMBER_INVITATION
- table:
    schema: public
    name: service_members
  object_relationships:
  - name: service
    using:
      foreign_key_constraint_on: service_id
  - name: user
    using:
      foreign_key_constraint_on: user_id
  select_permissions:
  - role: service
    permission:
      columns:
      - id
      - is_admin
      - service_id
      - user_id
      filter:
        service_id:
          _eq: X-Hasura-Service-Id
  - role: ti
    permission:
      columns:
      - id
      - user_id
      - service_id
      filter: {}
  update_permissions:
  - role: service
    permission:
      columns:
      - is_admin
      filter:
        service_id:
          _eq: X-Hasura-Service-Id
  delete_permissions:
  - role: service
    permission:
      filter:
        service_id:
          _eq: X-Hasura-Service-Id
- table:
    schema: public
    name: service_personnels
  object_relationships:
  - name: service
    using:
      foreign_key_constraint_on: service_id
  select_permissions:
  - role: service
    permission:
      columns:
      - id
      - created_at
      - service_id
      - nombre_postes_delegues_etp
      - nombre_delegues
      - nombre_poste_autre_personnel_etp
      - nombre_delegues_cnc
      - nombre_delegues_cnc_pjm
      - nombre_delegues_cnc_maj
      - nombre_delegues_cnc_dpf
      - nombre_delegues_en_formation
      - nombre_delegues_non_formes
      filter:
        service_id:
          _eq: x-hasura-service-id
  update_permissions:
  - role: service
    permission:
      columns:
      - nombre_poste_autre_personnel_etp
      - nombre_postes_delegues_etp
      - id
      - nombre_delegues
      - nombre_delegues_cnc
      - nombre_delegues_cnc_dpf
      - nombre_delegues_cnc_maj
      - nombre_delegues_cnc_pjm
      - nombre_delegues_en_formation
      - nombre_delegues_non_formes
      - service_id
      - created_at
      filter:
        service_id:
          _eq: x-hasura-service-id
- table:
    schema: public
    name: service_tis
  object_relationships:
  - name: service
    using:
      foreign_key_constraint_on: service_id
  - name: ti
    using:
      foreign_key_constraint_on: ti_id
  select_permissions:
  - role: service
    permission:
      columns:
      - id
      - service_id
      - ti_id
      filter: {}
- table:
    schema: public
    name: services
  object_relationships:
  - name: departement
    using:
      foreign_key_constraint_on: department_id
  array_relationships:
  - name: service_antennes
    using:
      foreign_key_constraint_on:
        column: service_id
        table:
          schema: public
          name: service_antenne
  - name: service_members
    using:
      foreign_key_constraint_on:
        column: service_id
        table:
          schema: public
          name: service_members
  - name: service_personnels
    using:
      foreign_key_constraint_on:
        column: service_id
        table:
          schema: public
          name: service_personnels
  - name: service_tis
    using:
      foreign_key_constraint_on:
        column: service_id
        table:
          schema: public
          name: service_tis
  select_permissions:
  - role: anonymous
    permission:
      columns:
      - code_postal
      - etablissement
      - id
      filter: {}
  - role: direction
    permission:
      columns:
      - adresse
      - code_postal
      - created_at
      - department_id
      - dispo_max
      - email
      - etablissement
      - id
      - competences
      - mesures_awaiting
      - mesures_in_progress
      - nom
      - prenom
      - telephone
      - ville
      filter: {}
      allow_aggregations: true
  - role: service
    permission:
      columns:
      - id
      - etablissement
      - email
      - nom
      - prenom
      - code_postal
      - ville
      - telephone
      - adresse
      - dispo_max
      - created_at
      - competences
      - department_id
      - mesures_in_progress
      - mesures_awaiting
      - latitude
      - longitude
      filter:
        id:
          _eq: X-Hasura-Service-Id
  - role: ti
    permission:
      columns:
      - id
      - etablissement
      - email
      - nom
      - prenom
      - code_postal
      - ville
      - telephone
      - adresse
      - dispo_max
      - created_at
      - competences
      - department_id
      - mesures_in_progress
      - mesures_awaiting
      - latitude
      - longitude
      filter: {}
  update_permissions:
  - role: service
    permission:
      columns:
      - adresse
      - code_postal
      - department_id
      - dispo_max
      - email
      - etablissement
      - id
      - competences
      - latitude
      - longitude
      - mesures_awaiting
      - mesures_in_progress
      - nom
      - prenom
      - telephone
      - ville
      filter:
        id:
          _eq: X-Hasura-Service-Id
  - role: ti
    permission:
      columns:
      - latitude
      - longitude
      - mesures_awaiting
      - mesures_in_progress
      filter: {}
- table:
    schema: public
    name: tis
  array_relationships:
  - name: commentaires
    using:
      foreign_key_constraint_on:
        column: ti_id
        table:
          schema: public
          name: commentaires
  - name: magistrats
    using:
      foreign_key_constraint_on:
        column: ti_id
        table:
          schema: public
          name: magistrat
  - name: mesures
    using:
      foreign_key_constraint_on:
        column: ti_id
        table:
          schema: public
          name: mesures
  - name: service_tis
    using:
      foreign_key_constraint_on:
        column: ti_id
        table:
          schema: public
          name: service_tis
  - name: user_tis
    using:
      foreign_key_constraint_on:
        column: ti_id
        table:
          schema: public
          name: user_tis
  select_permissions:
  - role: anonymous
    permission:
      columns:
      - address
      - address2
      - code_postal
      - created_at
      - date_fermeture
      - date_modification
      - date_ouverture
      - departement_id
      - email
      - etablissement
      - id
      - immutable
      - latitude
      - longitude
      - siret
      - telephone
      - type
      - updated_at
      - ville
      filter: {}
  - role: direction
    permission:
      columns:
      - immutable
      - date_fermeture
      - date_modification
      - date_ouverture
      - latitude
      - longitude
      - departement_id
      - id
      - created_at
      - updated_at
      - address
      - address2
      - code_postal
      - email
      - etablissement
      - siret
      - telephone
      - type
      - ville
      filter: {}
  - role: individuel
    permission:
      columns:
      - immutable
      - date_fermeture
      - date_modification
      - date_ouverture
      - latitude
      - longitude
      - departement_id
      - id
      - created_at
      - updated_at
      - address
      - address2
      - code_postal
      - email
      - etablissement
      - siret
      - telephone
      - type
      - ville
      filter: {}
  - role: prepose
    permission:
      columns:
      - immutable
      - date_fermeture
      - date_modification
      - date_ouverture
      - latitude
      - longitude
      - departement_id
      - id
      - created_at
      - updated_at
      - address
      - address2
      - code_postal
      - email
      - etablissement
      - siret
      - telephone
      - type
      - ville
      filter: {}
  - role: service
    permission:
      columns:
      - immutable
      - date_fermeture
      - date_modification
      - date_ouverture
      - latitude
      - longitude
      - departement_id
      - id
      - created_at
      - updated_at
      - address
      - address2
      - code_postal
      - email
      - etablissement
      - siret
      - telephone
      - type
      - ville
      filter: {}
  - role: ti
    permission:
      columns:
      - immutable
      - date_fermeture
      - date_modification
      - date_ouverture
      - latitude
      - longitude
      - departement_id
      - id
      - created_at
      - updated_at
      - address
      - address2
      - code_postal
      - email
      - etablissement
      - siret
      - telephone
      - type
      - ville
      filter: {}
- table:
    schema: public
    name: user_role
  object_relationships:
  - name: role
    using:
      foreign_key_constraint_on: role_id
  - name: user
    using:
      foreign_key_constraint_on: user_id
  select_permissions:
  - role: direction
    permission:
      columns:
      - id
      - role_id
      - user_id
      filter:
        user_id:
          _eq: X-Hasura-User-Id
  - role: individuel
    permission:
      columns: []
      filter:
        user_id:
          _eq: X-Hasura-User-Id
  - role: prepose
    permission:
      columns:
      - id
      - role_id
      - user_id
      filter:
        user_id:
          _eq: X-Hasura-User-Id
  - role: service
    permission:
      columns:
      - id
      - role_id
      - user_id
      filter:
        user_id:
          _eq: X-Hasura-User-Id
  - role: ti
    permission:
      columns:
      - id
      - role_id
      - user_id
      filter:
        user_id:
          _eq: X-Hasura-User-Id
- table:
    schema: public
    name: user_tis
  object_relationships:
  - name: ti
    using:
      foreign_key_constraint_on: ti_id
  - name: user
    using:
      foreign_key_constraint_on: user_id
  select_permissions:
  - role: individuel
    permission:
      columns:
      - id
      - ti_id
      - user_id
      - created_at
      filter:
        user_id:
          _eq: X-Hasura-User-Id
  - role: prepose
    permission:
      columns:
      - id
      - ti_id
      - user_id
      - created_at
      filter:
        user_id:
          _eq: X-Hasura-User-Id
- table:
    schema: public
    name: users
  object_relationships:
  - name: magistrat
    using:
      manual_configuration:
        remote_table:
          schema: public
          name: magistrat
        column_mapping:
          id: user_id
  - name: mandataire
    using:
      manual_configuration:
        remote_table:
          schema: public
          name: mandataires
        column_mapping:
          id: user_id
  array_relationships:
  - name: service_members
    using:
      foreign_key_constraint_on:
        column: user_id
        table:
          schema: public
          name: service_members
  - name: user_roles
    using:
      foreign_key_constraint_on:
        column: user_id
        table:
          schema: public
          name: user_role
  - name: user_tis
    using:
      foreign_key_constraint_on:
        column: user_id
        table:
          schema: public
          name: user_tis
  insert_permissions:
  - role: direction
    permission:
      check: {}
      columns:
      - id
      - username
      - password
      - created_at
      - type
      - last_login
      - active
      - reset_password_token
      - reset_password_expires
      - nom
      - prenom
      - cabinet
      - email
  - role: individuel
    permission:
      check:
        id:
          _eq: X-Hasura-User-Id
      columns:
      - active
      - id
      - created_at
      - last_login
      - reset_password_expires
      - cabinet
      - email
      - nom
      - password
      - prenom
      - reset_password_token
      - type
      - username
  - role: prepose
    permission:
      check:
        id:
          _eq: X-Hasura-User-Id
      columns:
      - active
      - id
      - created_at
      - last_login
      - reset_password_expires
      - cabinet
      - email
      - nom
      - password
      - prenom
      - reset_password_token
      - type
      - username
  - role: service
    permission:
      check:
        id:
          _eq: X-Hasura-User-Id
      columns:
      - active
      - id
      - created_at
      - last_login
      - reset_password_expires
      - cabinet
      - email
      - nom
      - password
      - prenom
      - reset_password_token
      - type
      - username
  - role: ti
    permission:
      check:
        id:
          _eq: X-Hasura-User-Id
      columns:
      - active
      - id
      - created_at
      - last_login
      - reset_password_expires
      - cabinet
      - email
      - nom
      - password
      - prenom
      - reset_password_token
      - type
      - username
  select_permissions:
  - role: anonymous
    permission:
      columns:
      - active
      - email
      - type
      filter:
        email:
          _eq: X-Hasura-Email
      limit: 1
  - role: direction
    permission:
      columns:
      - active
      - id
      - created_at
      - last_login
      - reset_password_expires
      - cabinet
      - email
      - nom
      - password
      - prenom
      - reset_password_token
      - type
      - username
      filter: {}
  - role: individuel
    permission:
      columns:
      - id
      - username
      - password
      - created_at
      - type
      - last_login
      - active
      - reset_password_token
      - reset_password_expires
      - nom
      - prenom
      - cabinet
      - email
      filter:
        id:
          _eq: X-Hasura-User-Id
  - role: prepose
    permission:
      columns:
      - active
      - id
      - created_at
      - last_login
      - reset_password_expires
      - cabinet
      - email
      - nom
      - password
      - prenom
      - reset_password_token
      - type
      - username
      filter:
        id:
          _eq: X-Hasura-User-Id
  - role: service
    permission:
      columns:
      - active
      - id
      - created_at
      - last_login
      - reset_password_expires
      - cabinet
      - email
      - nom
      - password
      - prenom
      - reset_password_token
      - type
      - username
      filter:
        _or:
        - id:
            _eq: X-Hasura-User-Id
        - service_members:
            service_id:
              _eq: X-Hasura-Service-Id
  - role: ti
    permission:
      columns:
      - cabinet
      - created_at
      - email
      - id
      - last_login
      - nom
      - prenom
      - type
      - username
      filter: {}
  update_permissions:
  - role: direction
    permission:
      columns:
      - active
      - id
      - created_at
      - last_login
      - reset_password_expires
      - cabinet
      - email
      - nom
      - password
      - prenom
      - reset_password_token
      - type
      - username
      filter:
        id:
          _eq: X-Hasura-User-Id
  - role: individuel
    permission:
      columns:
      - active
      - id
      - created_at
      - last_login
      - reset_password_expires
      - cabinet
      - email
      - nom
      - password
      - prenom
      - reset_password_token
      - type
      - username
      filter:
        id:
          _eq: X-Hasura-User-Id
  - role: prepose
    permission:
      columns:
      - active
      - id
      - created_at
      - last_login
      - reset_password_expires
      - cabinet
      - email
      - nom
      - password
      - prenom
      - reset_password_token
      - type
      - username
      filter:
        id:
          _eq: X-Hasura-User-Id
  - role: service
    permission:
      columns:
      - active
      - id
      - created_at
      - last_login
      - reset_password_expires
      - cabinet
      - email
      - nom
      - password
      - prenom
      - reset_password_token
      - type
      - username
      filter:
        id:
          _eq: X-Hasura-User-Id
  - role: ti
    permission:
      columns:
      - active
      - id
      - created_at
      - last_login
      - reset_password_expires
      - cabinet
      - email
      - nom
      - password
      - prenom
      - reset_password_token
      - type
      - username
      filter:
        id:
          _eq: X-Hasura-User-Id
  event_triggers:
  - name: email-account-validation
    definition:
      enable_manual: false
      update:
        columns:
        - active
    retry_conf:
      num_retries: 0
      interval_sec: 10
      timeout_sec: 60
    webhook_from_env: WEB_HOOK_URL_EMAIL_ACCOUNT_VALIDATION
- table:
    schema: public
    name: view_department_availability
  object_relationships:
  - name: department
    using:
      manual_configuration:
        remote_table:
          schema: public
          name: departements
        column_mapping:
          department_id: id
  select_permissions:
  - role: direction
    permission:
      columns:
      - department_id
      - mesures_awaiting
      - mesures_in_progress
      - mesures_max
      filter: {}
  - role: individuel
    permission:
      columns:
      - department_id
      - mesures_awaiting
      - mesures_in_progress
      - mesures_max
      filter: {}
  - role: prepose
    permission:
      columns:
      - department_id
      - mesures_awaiting
      - mesures_in_progress
      - mesures_max
      filter: {}
  - role: service
    permission:
      columns:
      - department_id
      - mesures_awaiting
      - mesures_in_progress
      - mesures_max
      filter: {}
  - role: ti
    permission:
      columns:
      - department_id
      - mesures_awaiting
      - mesures_in_progress
      - mesures_max
      filter: {}
- table:
    schema: public
    name: view_indicateur_inscrit
  select_permissions:
  - role: anonymous
    permission:
      columns:
      - code
      - count
      - nom
      - type
      filter: {}
      allow_aggregations: true
  - role: direction
    permission:
      columns:
      - code
      - nom
      - type
      - count
      filter: {}
      allow_aggregations: true
  - role: individuel
    permission:
      columns:
      - count
      - code
      - nom
      - type
      filter: {}
      allow_aggregations: true
  - role: prepose
    permission:
      columns:
      - count
      - code
      - nom
      - type
      filter: {}
      allow_aggregations: true
  - role: service
    permission:
      columns:
      - count
      - code
      - nom
      - type
      filter: {}
      allow_aggregations: true
  - role: ti
    permission:
      columns:
      - count
      - code
      - nom
      - type
      filter: {}
      allow_aggregations: true
- table:
    schema: public
    name: view_indicateur_login
  select_permissions:
  - role: anonymous
    permission:
      columns:
      - code
      - count
      - nom
      - type
      filter: {}
      allow_aggregations: true
  - role: direction
    permission:
      columns:
      - code
      - nom
      - type
      - count
      filter: {}
      allow_aggregations: true
  - role: individuel
    permission:
      columns:
      - count
      - code
      - nom
      - type
      filter: {}
      allow_aggregations: true
  - role: prepose
    permission:
      columns:
      - count
      - code
      - nom
      - type
      filter: {}
      allow_aggregations: true
  - role: service
    permission:
      columns:
      - count
      - code
      - nom
      - type
      filter: {}
      allow_aggregations: true
  - role: ti
    permission:
      columns:
      - count
      - code
      - nom
      - type
      filter: {}
      allow_aggregations: true
- table:
    schema: public
    name: view_indicateur_satisfaction_campaign
  select_permissions:
  - role: anonymous
    permission:
      columns:
      - value
      - code
      - nom
      - type
      filter: {}
      allow_aggregations: true
  - role: direction
    permission:
      columns:
      - code
      - nom
      - type
      - value
      filter: {}
      allow_aggregations: true
  - role: individuel
    permission:
      columns:
      - value
      - code
      - nom
      - type
      filter: {}
      allow_aggregations: true
  - role: prepose
    permission:
      columns:
      - value
      - code
      - nom
      - type
      filter: {}
      allow_aggregations: true
  - role: service
    permission:
      columns:
      - value
      - code
      - nom
      - type
      filter: {}
      allow_aggregations: true
  - role: ti
    permission:
      columns:
      - value
      - code
      - nom
      - type
      filter: {}
      allow_aggregations: true
- table:
    schema: public
    name: view_mesure_gestionnaire
  object_relationships:
  - name: departement
    using:
      manual_configuration:
        remote_table:
          schema: public
          name: departements
        column_mapping:
          department_id: id
  - name: mandataire
    using:
      manual_configuration:
        remote_table:
          schema: public
          name: mandataires
        column_mapping:
          mandataire_id: id
  - name: service
    using:
      manual_configuration:
        remote_table:
          schema: public
          name: services
        column_mapping:
          service_id: id
  array_relationships:
  - name: gestionnaire_tis
    using:
      manual_configuration:
        remote_table:
          schema: public
          name: view_mesure_gestionnaire_tis
        column_mapping:
          id: id
  select_permissions:
  - role: direction
    permission:
      columns:
      - id
      - service_id
      - mandataire_id
      - discriminator
      - department_id
      - dep_nom
      - mesures_max
      - mesures_awaiting
      - mesures_in_progress
      - remaining_capacity
      filter: {}
      allow_aggregations: true
  - role: individuel
    permission:
      columns:
      - id
      - service_id
      - mandataire_id
      - discriminator
      - department_id
      - dep_nom
      - mesures_max
      - mesures_awaiting
      - mesures_in_progress
      - remaining_capacity
      filter: {}
  - role: prepose
    permission:
      columns:
      - department_id
      - mandataire_id
      - mesures_max
      - service_id
      - mesures_awaiting
      - mesures_in_progress
      - remaining_capacity
      - discriminator
      - id
      - dep_nom
      filter: {}
  - role: service
    permission:
      columns:
      - department_id
      - mandataire_id
      - mesures_max
      - service_id
      - mesures_awaiting
      - mesures_in_progress
      - remaining_capacity
      - discriminator
      - id
      - dep_nom
      filter: {}
  - role: ti
    permission:
      columns:
      - dep_nom
      - department_id
      - discriminator
      - id
      - mandataire_id
      - mesures_awaiting
      - mesures_in_progress
      - mesures_max
      - nom
      - remaining_capacity
      - service_id
      filter: {}
      allow_aggregations: true
- table:
    schema: public
    name: view_mesure_gestionnaire_tis
  object_relationships:
  - name: gestionnaire
    using:
      manual_configuration:
        remote_table:
          schema: public
          name: view_mesure_gestionnaire
        column_mapping:
          id: id
  - name: tis
    using:
      manual_configuration:
        remote_table:
          schema: public
          name: tis
        column_mapping:
          ti_id: id
  select_permissions:
  - role: ti
    permission:
      columns:
      - id
      - service_id
      - mandataire_id
      - discriminator
      - ti_id
      filter: {}
      allow_aggregations: true
remote_schemas:
- name: remote_schema
  definition:
    url_from_env: WHATEVER_URL
    timeout_seconds: 60
    forward_client_headers: true
